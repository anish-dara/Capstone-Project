{% extends "base.html" %}

{% block content %}
<div class="row">
    <div class="col-12">
        <h1 class="mb-4">2023 Season Leaders - {{ current_stat }}</h1>
    </div>
</div>

<div class="row mb-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-filter"></i> Select Stat Category</h5>
            </div>
            <div class="card-body">
                <div class="btn-group-vertical d-md-none" role="group">
                    {% for stat_key, stat_info in stat_definitions.items() %}
                    <a href="/?stat={{ stat_key }}" class="btn {% if selected_stat == stat_key %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1">
                        {{ stat_info.name }}
                    </a>
                    {% endfor %}
                </div>
                <div class="d-none d-md-block">
                    <div class="row">
                        <div class="col-md-3">
                            <h6>Passing</h6>
                            <a href="/?stat=passing_yards" class="btn {% if selected_stat == 'passing_yards' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Pass Yards</a>
                            <a href="/?stat=pass_tds" class="btn {% if selected_stat == 'pass_tds' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Pass TDs</a>
                            <a href="/?stat=passing_epa" class="btn {% if selected_stat == 'passing_epa' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Pass EPA</a>
                        </div>
                        <div class="col-md-3">
                            <h6>Rushing</h6>
                            <a href="/?stat=rushing_yards" class="btn {% if selected_stat == 'rushing_yards' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rush Yards</a>
                            <a href="/?stat=rush_tds" class="btn {% if selected_stat == 'rush_tds' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rush TDs</a>
                            <a href="/?stat=rushing_epa" class="btn {% if selected_stat == 'rushing_epa' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rush EPA</a>
                        </div>
                        <div class="col-md-3">
                            <h6>Receiving</h6>
                            <a href="/?stat=receiving_yards" class="btn {% if selected_stat == 'receiving_yards' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rec Yards</a>
                            <a href="/?stat=rec_tds" class="btn {% if selected_stat == 'rec_tds' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rec TDs</a>
                            <a href="/?stat=receptions" class="btn {% if selected_stat == 'receptions' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Receptions</a>
                            <a href="/?stat=receiving_epa" class="btn {% if selected_stat == 'receiving_epa' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Rec EPA</a>
                        </div>
                        <div class="col-md-3">
                            <h6>Defense</h6>
                            <a href="/?stat=sacks" class="btn {% if selected_stat == 'sacks' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Sacks</a>
                            <a href="/?stat=tackles" class="btn {% if selected_stat == 'tackles' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Tackles</a>
                            <a href="/?stat=interceptions" class="btn {% if selected_stat == 'interceptions' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">INTs</a>
                            <a href="/?stat=def_pass_defended" class="btn {% if selected_stat == 'def_pass_defended' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Pass Def</a>
                            <a href="/?stat=def_fumbles_forced" class="btn {% if selected_stat == 'def_fumbles_forced' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">FF</a>
                        </div>
                    </div>
                    <div class="row mt-2">
                        <div class="col-md-4">
                            <h6>Special Teams</h6>
                            <a href="/?stat=fgm" class="btn {% if selected_stat == 'fgm' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">FG Made</a>
                            <a href="/?stat=fga" class="btn {% if selected_stat == 'fga' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">FG Att</a>
                            <a href="/?stat=fg_percentage" class="btn {% if selected_stat == 'fg_percentage' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">FG%</a>
                        </div>
                        <div class="col-md-8">
                            <h6>Fantasy Points</h6>
                            <a href="/?stat=fantasy_points" class="btn {% if selected_stat == 'fantasy_points' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">Standard</a>
                            <a href="/?stat=fantasy_points_ppr" class="btn {% if selected_stat == 'fantasy_points_ppr' %}btn-primary{% else %}btn-outline-primary{% endif %} btn-sm mb-1 me-1">PPR</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-trophy"></i> Top 20 - {{ current_stat }}</h5>
            </div>
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead class="table-dark">
                            <tr>
                                <th>Rank</th>
                                <th>Player</th>
                                <th>Position</th>
                                <th>Team</th>
                                <th>{{ current_stat }}</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for leader in leaders %}
                            <tr>
                                <td><strong>{{ loop.index }}</strong></td>
                                <td>
                                    <a href="/player/{{ leader.player_id }}" class="text-decoration-none">
                                        {{ leader.full_name or "Unknown" }}
                                    </a>
                                </td>
                                <td>
                                    <span class="badge 
                                        {% if leader.position == 'QB' %}bg-success
                                        {% elif leader.position == 'RB' %}bg-warning text-dark
                                        {% elif leader.position == 'WR' %}bg-info
                                        {% elif leader.position == 'TE' %}bg-primary
                                        {% elif leader.position == 'DE' %}bg-danger
                                        {% elif leader.position == 'LB' %}bg-dark
                                        {% elif leader.position == 'DT' %}text-white" style="background-color: #6f42c1;
                                        {% elif leader.position == 'OLB' %}text-white" style="background-color: #fd7e14;
                                        {% elif leader.position == 'ILB' %}text-white" style="background-color: #20c997;
                                        {% elif leader.position == 'DL' %}text-white" style="background-color: #e83e8c;
                                        {% elif leader.position == 'DB' %}bg-secondary
                                        {% elif leader.position == 'CB' %}text-white" style="background-color: #6610f2;
                                        {% elif leader.position == 'S' %}text-white" style="background-color: #d63384;
                                        {% elif leader.position == 'OL' %}text-white" style="background-color: #495057;
                                        {% elif leader.position == 'K' %}text-white" style="background-color: #fd7e14;
                                        {% elif leader.position == 'P' %}text-white" style="background-color: #198754;
                                        {% elif leader.position == 'LS' %}text-white" style="background-color: #0d6efd;
                                        {% else %}bg-light text-dark{% endif %}">
                                        {{ leader.position }}
                                    </span>
                                </td>
                                <td>{{ leader.team }}</td>
                                <td><strong>
                                    {% if selected_stat == 'fg_percentage' %}
                                        {{ "%.1f"|format((leader.total_stat or 0) * 100) }}%
                                    {% else %}
                                        {{ "%.1f"|format(leader.total_stat or 0) }}
                                    {% endif %}
                                </strong></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="row mt-4">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="fas fa-search"></i> Quick Search</h5>
            </div>
            <div class="card-body">
                <div class="input-group">
                    <input type="text" class="form-control" placeholder="Search players..." id="playerSearch">
                    <button class="btn btn-primary" type="button" id="searchButton">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}